{"version":3,"sources":["webpack:///build/bundle.js","webpack:///webpack/bootstrap 93ebeba8907a0a04b647","webpack:///./js/Main.js","webpack:///./js/Util/FileFormat.js","webpack:///./js/Util/BinaryReader.js","webpack:///./js/Util/ExtendableError.js","webpack:///./js/Core/Project.js","webpack:///./js/Core/Layer.js","webpack:///./js/Util/EntityIDs.js","webpack:///./js/Entities/StickFigure.js","webpack:///./js/Util/Drawing.js","webpack:///./js/Util/Interpolation.js","webpack:///./js/Entities/BitmapObject.js","webpack:///./js/Entities/LineObject.js","webpack:///./js/Entities/RectObject.js","webpack:///./js/Entities/CircleObject.js","webpack:///./js/Entities/PolyObject.js","webpack:///./js/Entities/TextObject.js","webpack:///./js/Entities/Camera.js","webpack:///./js/Core/Frameset.js","webpack:///./js/Core/Keyframe.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","playFrame","time","isPlaying","playStartTime","frame","undefined","x","project","fps","Math","floor","animSpeed","playStartFrame","eTime","value","draw","getEndTime","setPlaying","requestAnimationFrame","state","parseFloat","eBtnPlay","textContent","eText","context","eView","getContext","fillStyle","_FileFormat","TisfatColorToCSS","backgroundColor","fillRect","width","height","save","cameraLayer","layers","cameraState","findCurrentState","data","transform","restore","onProjectLoad","eTextView","style","display","eMainView","max","_BinaryReader","_BinaryReader2","_Project","_Project2","FILE_FORMAT_VERSION","top","self","document","body","getElementById","eLink","addEventListener","href","location","search","substring","BadVersionError","version","maxSupported","this","HTTPError","fetch","then","response","ok","arrayBuffer","reader","ReadUInt16","read","error","console","log","stack","color","_color","_slicedToArray","a","r","g","b","TisfatReadList","func","list","count","i","push","TisfatReadColor","ReadByte","TisfatReadBitmap","bytes","ReadInt32","buffer","Read","blob","Blob","type","domURL","window","URL","webkitURL","url","createObjectURL","img","Image","onload","revokeObjectURL","src","TisfatReadPointF","ReadDouble","y","TisfatReadVec3","z","Object","defineProperty","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","length","err","Array","isArray","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","DataFormatError","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","_ExtendableError2","_ExtendableError3","_ExtendableError","getPrototypeOf","apply","arguments","BinaryReader","littleEndian","dataView","DataView","cursor","slice","getUint8","getUint16","getUint32","getInt32","getFloat64","shift","test","Read7BitEncodedInt","decoded","String","fromCharCode","Uint8Array","ExtendableError","_Error","message","_this","Error","name","_Layer","_Layer2","_Frameset","_Frameset2","_Keyframe","_Keyframe2","_Camera","Project","ctx","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","layer","endTime","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","framesets","camera","Camera","frameset","timelineColor","keyframes","createRefState","map","l","unshift","createCameraLayer","_EntityIDs","Layer","visible","depth","getStartTime","findFrameset","nextIndex","current","t","interpolate","interpMode","ReadString","ReadBoolean","TisfatResolveEntityID","TisfatEntityTypes","TisfatResolveEntityStateID","TisfatEntityStateTypes","_StickFigure","_BitmapObject","_LineObject","_RectObject","_CircleObject","_PolyObject","_TextObject","0","StickFigure","1","BitmapObject","3","LineObject","4","RectObject","5","CircleObject","6","PolyObject","7","TextObject","8","9","StickFigureState","BitmapObjectState","LineObjectState","RectObjectState","CircleObjectState","PolyObjectState","TextObjectState","CameraState","StickFigureJoint","StickFigureJointState","_Drawing","_Interpolation","parent","children","jointColor","thickness","bitmapIndex","manipulatable","child","mode","InterpolatePointF","InterpolateColor","Interpolate","root","figure","handleColor","initialBitmapIndex","handleVisible","drawTo","otherJoint","otherState","drawType","dx","dy","sqrt","TisfatCircle","TisfatCappedLine","joint","names","center","radius","beginPath","arc","PI","fill","moveTo","lineTo","lineWidth","strokeStyle","stroke","pow","min","size","rotation","alpha","_state$location","_state$size","globalAlpha","drawImage","bitmap","object","position","extent","PolyObjectJoint","points","append","isFirst","closePath","FontStyleMap","Bold","Italic","Regular","TextAlignmentMap","Center","Far","Near","TextBaselineMap","font","textFont","textColor","textAlign","textAlignment","textBaseline","fillText","text","fontName","fontSize","fontStyle","scale","angle","inv","translate","rotate","Frameset","Keyframe","keyframe","ReadUInt32"],"mappings":"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","file":"./build/bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* global self */\n\t\n\t\"use strict\";\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _BinaryReader = __webpack_require__(2);\n\t\n\tvar _BinaryReader2 = _interopRequireDefault(_BinaryReader);\n\t\n\tvar _Project = __webpack_require__(4);\n\t\n\tvar _Project2 = _interopRequireDefault(_Project);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar FILE_FORMAT_VERSION = 7;\n\t\n\tif (top === self) document.body.style.backgroundColor = \"black\";\n\t\n\tvar eTextView = document.getElementById(\"text-view\");\n\tvar eMainView = document.getElementById(\"main-view\");\n\t\n\teTextView.style.display = \"block\";\n\teTextView.textContent = \"Initializing player...\";\n\t\n\tvar eView = document.getElementById(\"view\");\n\tvar eTime = document.getElementById(\"time\");\n\tvar eText = document.getElementById(\"text\");\n\tvar eLink = document.getElementById(\"link\");\n\tvar eBtnPlay = document.getElementById(\"btn-play\");\n\t\n\tvar project = null;\n\tvar isPlaying = false;\n\tvar playStartFrame = null;\n\tvar playStartTime = null;\n\t\n\tfunction playFrame(time) {\n\t  if (!isPlaying) return;\n\t\n\t  if (playStartTime === null) playStartTime = time;\n\t\n\t  // const frame = playStartFrame + (time - playStartTime) / 1000 * project.fps;\n\t  var frame = undefined;\n\t  frame = (time - playStartTime) / 1000;\n\t  var x = 1.0 / project.fps;\n\t  frame = Math.floor(frame / x) * x; // this seems inefficient\n\t  frame *= project.animSpeed;\n\t  frame += playStartFrame;\n\t\n\t  eTime.value = frame;\n\t  draw();\n\t\n\t  if (frame >= project.getEndTime()) setPlaying(false);else requestAnimationFrame(playFrame);\n\t}\n\t\n\tfunction setPlaying(state) {\n\t  if (state) {\n\t    if (!isPlaying) requestAnimationFrame(playFrame);\n\t\n\t    if (eTime.value >= project.getEndTime()) eTime.value = 0;\n\t\n\t    isPlaying = true;\n\t    playStartTime = null;\n\t    playStartFrame = parseFloat(eTime.value);\n\t\n\t    eBtnPlay.textContent = \"Pause\";\n\t  } else {\n\t    isPlaying = false;\n\t    playStartTime = null;\n\t    playStartFrame = null;\n\t\n\t    eBtnPlay.textContent = \"Play\";\n\t  }\n\t}\n\t\n\tfunction draw() {\n\t  if (project === null) return;\n\t\n\t  eText.textContent = \"Frame \" + (Math.floor(eTime.value) + 1) + \"/\" + (project.getEndTime() + 1);\n\t\n\t  var context = eView.getContext(\"2d\");\n\t\n\t  context.fillStyle = (0, _FileFormat.TisfatColorToCSS)(project.backgroundColor);\n\t  context.fillRect(0, 0, eView.width, eView.height);\n\t\n\t  context.save();\n\t\n\t  var cameraLayer = project.layers[0];\n\t  var cameraState = cameraLayer.findCurrentState(eTime.value);\n\t  cameraLayer.data.transform(context, cameraState);\n\t\n\t  project.draw(context, eTime.value);\n\t  context.restore();\n\t}\n\t\n\tfunction onProjectLoad() {\n\t  eTextView.style.display = \"none\";\n\t  eMainView.style.display = \"block\";\n\t\n\t  eView.width = project.width;\n\t  eView.height = project.height;\n\t\n\t  eTime.max = project.getEndTime();\n\t  eTime.value = 0;\n\t  eTime.style.width = project.width + \"px\";\n\t\n\t  draw();\n\t}\n\t\n\teBtnPlay.addEventListener(\"click\", function () {\n\t  if (project === null) return;\n\t\n\t  setPlaying(!isPlaying);\n\t});\n\t\n\teTime.addEventListener(\"input\", function () {\n\t  if (isPlaying) {\n\t    playStartTime = null;\n\t    playStartFrame = parseFloat(eTime.value);\n\t  }\n\t\n\t  draw();\n\t});\n\t\n\teTextView.textContent = \"Loading TISFAT Zero project...\";\n\teLink.href = location.search.substring(1);\n\t\n\tvar BadVersionError = function BadVersionError(version, maxSupported) {\n\t  _classCallCheck(this, BadVersionError);\n\t\n\t  this.version = version;\n\t  this.maxSupported = maxSupported;\n\t};\n\t\n\tvar HTTPError = function HTTPError() {\n\t  _classCallCheck(this, HTTPError);\n\t};\n\t\n\tfetch(eLink.href).then(function (response) {\n\t  if (!response.ok) throw new HTTPError();\n\t\n\t  return response.arrayBuffer();\n\t}).then(function (arrayBuffer) {\n\t  eTextView.textContent = \"Parsing TISFAT Zero project...\";\n\t  var reader = new _BinaryReader2.default(arrayBuffer, true);\n\t  var version = reader.ReadUInt16();\n\t\n\t  if (version > FILE_FORMAT_VERSION) throw new BadVersionError(version, FILE_FORMAT_VERSION);\n\t\n\t  project = _Project2.default.read(reader, version);\n\t  onProjectLoad();\n\t}).catch(function (error) {\n\t  console.error(error);\n\t  console.log(error.stack);\n\t\n\t  if (error instanceof HTTPError) {\n\t    eTextView.textContent = \"Failed to fetch the project file from '\" + eLink.href + \"'.\\n                             Check for bad links or CORS support.\";\n\t  } else if (error instanceof BadVersionError) {\n\t    eTextView.textContent = \"Failed to parse the project (file format version \" + error.version + \",\\n                             this viewer only supports up to version \" + error.maxSupported + \")\";\n\t  } else {\n\t    eTextView.textContent = \"Something unhandled went wrong while trying to load the project. \" + error;\n\t  }\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\t// not the right place for this\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\texports.TisfatColorToCSS = TisfatColorToCSS;\n\texports.TisfatReadList = TisfatReadList;\n\texports.TisfatReadColor = TisfatReadColor;\n\texports.TisfatReadBitmap = TisfatReadBitmap;\n\texports.TisfatReadPointF = TisfatReadPointF;\n\texports.TisfatReadVec3 = TisfatReadVec3;\n\tfunction TisfatColorToCSS(color) {\n\t  var _color = _slicedToArray(color, 4);\n\t\n\t  var a = _color[0];\n\t  var r = _color[1];\n\t  var g = _color[2];\n\t  var b = _color[3];\n\t\n\t  return \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a / 255 + \")\";\n\t}\n\t\n\tfunction TisfatReadList(reader, version, func) {\n\t  var list = [];\n\t  var count = reader.ReadUInt16();\n\t\n\t  for (var i = 0; i < count; i++) {\n\t    list.push(func(reader, version));\n\t  }\n\t\n\t  return list;\n\t}\n\t\n\tfunction TisfatReadColor(reader, version) {\n\t  var a = reader.ReadByte();\n\t  var r = reader.ReadByte();\n\t  var g = reader.ReadByte();\n\t  var b = reader.ReadByte();\n\t  return [a, r, g, b];\n\t}\n\t\n\tfunction TisfatReadBitmap(reader) {\n\t  var bytes = reader.ReadInt32();\n\t  var buffer = reader.Read(bytes);\n\t\n\t  var blob = new Blob([buffer], { type: \"image/png\" });\n\t\n\t  var domURL = window.URL || window.webkitURL || window;\n\t  var url = domURL.createObjectURL(blob);\n\t  var img = new Image();\n\t\n\t  img.onload = function () {\n\t    return domURL.revokeObjectURL(url);\n\t  };\n\t  img.src = url;\n\t\n\t  return img;\n\t}\n\t\n\tfunction TisfatReadPointF(reader) {\n\t  var x = reader.ReadDouble();\n\t  var y = reader.ReadDouble();\n\t  return [x, y];\n\t}\n\t\n\tfunction TisfatReadVec3(reader) {\n\t  var x = reader.ReadDouble();\n\t  var y = reader.ReadDouble();\n\t  var z = reader.ReadDouble();\n\t  return [x, y, z];\n\t}\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.DataFormatError = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _ExtendableError2 = __webpack_require__(3);\n\t\n\tvar _ExtendableError3 = _interopRequireDefault(_ExtendableError2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar DataFormatError = exports.DataFormatError = function (_ExtendableError) {\n\t  _inherits(DataFormatError, _ExtendableError);\n\t\n\t  function DataFormatError() {\n\t    _classCallCheck(this, DataFormatError);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(DataFormatError).apply(this, arguments));\n\t  }\n\t\n\t  return DataFormatError;\n\t}(_ExtendableError3.default);\n\t\n\tvar BinaryReader = function () {\n\t  function BinaryReader(arrayBuffer, littleEndian) {\n\t    _classCallCheck(this, BinaryReader);\n\t\n\t    this.arrayBuffer = arrayBuffer;\n\t    this.dataView = new DataView(arrayBuffer);\n\t    this.littleEndian = littleEndian;\n\t    this.cursor = 0;\n\t  }\n\t\n\t  _createClass(BinaryReader, [{\n\t    key: \"Read\",\n\t    value: function Read(count) {\n\t      var value = this.arrayBuffer.slice(this.cursor, this.cursor + count);\n\t      this.cursor += count;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"ReadBoolean\",\n\t    value: function ReadBoolean() {\n\t      return this.ReadByte() !== 0;\n\t    }\n\t  }, {\n\t    key: \"ReadByte\",\n\t    value: function ReadByte() {\n\t      var value = this.dataView.getUint8(this.cursor, this.littleEndian);\n\t      this.cursor++;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"ReadUInt16\",\n\t    value: function ReadUInt16() {\n\t      var value = this.dataView.getUint16(this.cursor, this.littleEndian);\n\t      this.cursor += 2;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"ReadUInt32\",\n\t    value: function ReadUInt32() {\n\t      var value = this.dataView.getUint32(this.cursor, this.littleEndian);\n\t      this.cursor += 4;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"ReadInt32\",\n\t    value: function ReadInt32() {\n\t      var value = this.dataView.getInt32(this.cursor, this.littleEndian);\n\t      this.cursor += 4;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"ReadDouble\",\n\t    value: function ReadDouble() {\n\t      var value = this.dataView.getFloat64(this.cursor, this.littleEndian);\n\t      this.cursor += 8;\n\t      return value;\n\t    }\n\t  }, {\n\t    key: \"Read7BitEncodedInt\",\n\t    value: function Read7BitEncodedInt() {\n\t      // Read out an Int32 7 bits at a time.  The high bit\n\t      // of the byte when on means to continue reading more bytes.\n\t      var count = 0;\n\t      var shift = 0;\n\t      var b;\n\t      do {\n\t        // Check for a corrupted stream.  Read a max of 5 bytes.\n\t        // In a future version, add a DataFormatException.\n\t        if (shift == 5 * 7) // 5 bytes max per Int32, shift += 7\n\t          throw new DataFormatError(\"Bad 7-bit encoded Int32\");\n\t\n\t        // ReadByte handles end of stream cases for us.\n\t        b = this.ReadByte();\n\t        count |= (b & 0x7F) << shift;\n\t        shift += 7;\n\t      } while ((b & 0x80) !== 0);\n\t      return count;\n\t    }\n\t  }, {\n\t    key: \"ReadString\",\n\t    value: function ReadString() {\n\t      //var test = this.ReadByte();\n\t      //if (test >= 127) throw new Error(\"watch out\");\n\t      var test = this.Read7BitEncodedInt();\n\t      var data = this.Read(test);\n\t      var decoded = String.fromCharCode.apply(null, new Uint8Array(data));\n\t      return decoded;\n\t    }\n\t  }]);\n\t\n\t  return BinaryReader;\n\t}();\n\n\texports.default = BinaryReader;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar ExtendableError = function (_Error) {\n\t  _inherits(ExtendableError, _Error);\n\t\n\t  function ExtendableError(message) {\n\t    _classCallCheck(this, ExtendableError);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this));\n\t\n\t    _this.message = message;\n\t    _this.stack = new Error().stack;\n\t    _this.name = _this.constructor.name;\n\t    return _this;\n\t  }\n\t\n\t  return ExtendableError;\n\t}(Error);\n\t\n\texports.default = ExtendableError;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layer = __webpack_require__(5);\n\t\n\tvar _Layer2 = _interopRequireDefault(_Layer);\n\t\n\tvar _Frameset = __webpack_require__(17);\n\t\n\tvar _Frameset2 = _interopRequireDefault(_Frameset);\n\t\n\tvar _Keyframe = __webpack_require__(18);\n\t\n\tvar _Keyframe2 = _interopRequireDefault(_Keyframe);\n\t\n\tvar _Camera = __webpack_require__(16);\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Project = function () {\n\t  function Project() {\n\t    _classCallCheck(this, Project);\n\t\n\t    this.layers = [];\n\t    this.animSpeed = 10.0;\n\t    this.fps = 60.0;\n\t    this.width = 460;\n\t    this.height = 360;\n\t    this.backgroundColor = [255, 255, 255, 255];\n\t  }\n\t\n\t  _createClass(Project, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, time) {\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = this.layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var layer = _step.value;\n\t\n\t          layer.draw(ctx, time);\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: \"getEndTime\",\n\t    value: function getEndTime() {\n\t      var endTime = 0;\n\t\n\t      var _iteratorNormalCompletion2 = true;\n\t      var _didIteratorError2 = false;\n\t      var _iteratorError2 = undefined;\n\t\n\t      try {\n\t        for (var _iterator2 = this.layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t          var layer = _step2.value;\n\t\n\t          endTime = Math.max(endTime, layer.framesets[layer.framesets.length - 1].getEndTime());\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t            _iterator2.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError2) {\n\t            throw _iteratorError2;\n\t          }\n\t        }\n\t      }\n\t\n\t      return endTime;\n\t    }\n\t  }, {\n\t    key: \"createCameraLayer\",\n\t    value: function createCameraLayer() {\n\t      var camera = new _Camera.Camera();\n\t      var layer = new _Layer2.default();\n\t      var frameset = new _Frameset2.default();\n\t\n\t      layer.name = \"Camera\";\n\t      layer.timelineColor = [255, 70, 120, 255];\n\t      layer.data = camera;\n\t\n\t      frameset.keyframes.push(new _Keyframe2.default(0, camera.createRefState()));\n\t      frameset.keyframes.push(new _Keyframe2.default(this.getEndTime(), camera.createRefState()));\n\t      layer.framesets.push(frameset);\n\t\n\t      return layer;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var project = new Project();\n\t\n\t      project.layers = (0, _FileFormat.TisfatReadList)(reader, version, _Layer2.default.read);\n\t      console.log(project.layers.map(function (l) {\n\t        return l.name;\n\t      }));\n\t\n\t      if (version < 6) {\n\t        project.layers.unshift(project.createCameraLayer());\n\t        /* Camera camera = new Camera();\n\t        Layers.Insert(0, camera.CreateDefaultLayer(0, (uint)Program.MainTimeline.GetLastTime(), null)); */\n\t      }\n\t\n\t      if (version >= 1) {\n\t        project.animSpeed = reader.ReadDouble();\n\t\n\t        if (version >= 5) project.fps = reader.ReadDouble();\n\t\n\t        if (version >= 2) {\n\t          project.width = reader.ReadInt32();\n\t          project.height = reader.ReadInt32();\n\t          project.backgroundColor = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t        }\n\t      }\n\t\n\t      return project;\n\t    }\n\t  }]);\n\t\n\t  return Project;\n\t}();\n\n\texports.default = Project;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _EntityIDs = __webpack_require__(6);\n\t\n\tvar _Frameset = __webpack_require__(17);\n\t\n\tvar _Frameset2 = _interopRequireDefault(_Frameset);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layer = function () {\n\t  function Layer() {\n\t    _classCallCheck(this, Layer);\n\t\n\t    this.name = \"Layer\";\n\t    this.visible = true;\n\t    this.timelineColor = \"aliceblue\";\n\t    this.data = null;\n\t    this.framesets = [];\n\t    this.depth = 0;\n\t  }\n\t\n\t  _createClass(Layer, [{\n\t    key: \"findFrameset\",\n\t    value: function findFrameset(time) {\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = this.framesets[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var frameset = _step.value;\n\t\n\t          if (time >= frameset.getStartTime() && time <= frameset.getEndTime()) return frameset;\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t\n\t      return null;\n\t    }\n\t  }, {\n\t    key: \"findCurrentState\",\n\t    value: function findCurrentState(time) {\n\t      if (!this.visible || this.data === null) return null;\n\t\n\t      var frameset = this.findFrameset(time);\n\t\n\t      if (frameset === null) return null;\n\t\n\t      var nextIndex = undefined;\n\t\n\t      for (nextIndex = 1; nextIndex < frameset.keyframes.length; nextIndex++) {\n\t        if (frameset.keyframes[nextIndex].time >= time) break;\n\t      }\n\t\n\t      var current = frameset.keyframes[nextIndex - 1];\n\t      var target = frameset.keyframes[nextIndex];\n\t\n\t      var t = (time - current.time) / (target.time - current.time);\n\t      return this.data.interpolate(t, current.state, target.state, current.interpMode);\n\t    }\n\t  }, {\n\t    key: \"draw\",\n\t    value: function draw(ctx, time) {\n\t      var state = this.findCurrentState(time);\n\t\n\t      if (state !== null) this.data.draw(ctx, state);\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var layer = new Layer();\n\t      layer.name = reader.ReadString();\n\t      layer.visible = reader.ReadBoolean();\n\t      layer.timelineColor = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      var type = (0, _EntityIDs.TisfatResolveEntityID)(reader.ReadUInt16());\n\t      layer.data = type.read(reader, version);\n\t      layer.framesets = (0, _FileFormat.TisfatReadList)(reader, version, _Frameset2.default.read);\n\t\n\t      return layer;\n\t    }\n\t  }]);\n\t\n\t  return Layer;\n\t}();\n\n\texports.default = Layer;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.TisfatResolveEntityID = TisfatResolveEntityID;\n\texports.TisfatResolveEntityStateID = TisfatResolveEntityStateID;\n\t\n\tvar _StickFigure = __webpack_require__(7);\n\t\n\tvar _BitmapObject = __webpack_require__(10);\n\t\n\tvar _LineObject = __webpack_require__(11);\n\t\n\tvar _RectObject = __webpack_require__(12);\n\t\n\tvar _CircleObject = __webpack_require__(13);\n\t\n\tvar _PolyObject = __webpack_require__(14);\n\t\n\tvar _TextObject = __webpack_require__(15);\n\t\n\tvar _Camera = __webpack_require__(16);\n\t\n\t// import {PointLight, PointLightState} from \"../Entities/PointLight.js\";\n\t\n\t\n\tvar TisfatEntityTypes = {\n\t  \"0\": /* CustomFigure */_StickFigure.StickFigure,\n\t  \"1\": _BitmapObject.BitmapObject,\n\t  // \"2\": PointLight,\n\t  \"3\": _LineObject.LineObject,\n\t  \"4\": _RectObject.RectObject,\n\t  \"5\": _CircleObject.CircleObject,\n\t  \"6\": _PolyObject.PolyObject,\n\t  \"7\": _TextObject.TextObject,\n\t  \"8\": _StickFigure.StickFigure,\n\t  \"9\": _Camera.Camera\n\t};\n\t\n\tvar TisfatEntityStateTypes = {\n\t  \"0\": /* CustomFigureState */_StickFigure.StickFigureState,\n\t  \"1\": _BitmapObject.BitmapObjectState,\n\t  // \"2\": PointLightState,\n\t  \"3\": _LineObject.LineObjectState,\n\t  \"4\": _RectObject.RectObjectState,\n\t  \"5\": _CircleObject.CircleObjectState,\n\t  \"6\": _PolyObject.PolyObjectState,\n\t  \"7\": _TextObject.TextObjectState,\n\t  \"8\": _StickFigure.StickFigureState,\n\t  \"9\": _Camera.CameraState\n\t};\n\t\n\tfunction TisfatResolveEntityID(id) {\n\t  if (TisfatEntityTypes[id]) return TisfatEntityTypes[id];\n\t\n\t  throw new Error(\"cannot resolve entity id \" + id);\n\t}\n\t\n\tfunction TisfatResolveEntityStateID(id) {\n\t  if (TisfatEntityStateTypes[id]) return TisfatEntityStateTypes[id];\n\t\n\t  throw new Error(\"cannot resolve entity state id \" + id);\n\t}\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.StickFigureJoint = exports.StickFigureState = exports.StickFigure = exports.StickFigureJointState = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Drawing = __webpack_require__(8);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar StickFigureJointState = exports.StickFigureJointState = function () {\n\t  function StickFigureJointState() {\n\t    _classCallCheck(this, StickFigureJointState);\n\t\n\t    this.parent = null;\n\t    this.children = [];\n\t    this.location = [0, 0];\n\t    this.jointColor = [255, 0, 0, 0];\n\t    this.thickness = 6;\n\t    this.bitmapIndex = -1;\n\t    this.manipulatable = true;\n\t  }\n\t\n\t  _createClass(StickFigureJointState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new StickFigureJointState();\n\t      state.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.jointColor = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      state.thickness = reader.ReadDouble();\n\t\n\t      if (version >= 2) {\n\t        state.manipulatable = reader.ReadBoolean();\n\t\n\t        if (version >= 4) state.bitmapIndex = reader.ReadInt32();\n\t      }\n\t\n\t      state.children = (0, _FileFormat.TisfatReadList)(reader, version, StickFigureJointState.read);\n\t\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = state.children[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var child = _step.value;\n\t\n\t          child.parent = state;\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t\n\t      return state;\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new StickFigureJointState();\n\t      state.parent = current.parent;\n\t      state.bitmapIndex = current.bitmapIndex;\n\t\n\t      state.location = (0, _Interpolation.InterpolatePointF)(t, current.location, target.location, mode);\n\t      state.jointColor = (0, _Interpolation.InterpolateColor)(t, current.jointColor, target.jointColor, mode);\n\t      state.thickness = (0, _Interpolation.Interpolate)(t, current.thickness, target.thickness, mode);\n\t\n\t      for (var i = 0; i < current.children.length; i++) {\n\t        state.children.push(StickFigureJointState.interpolate(t, current.children[i], target.children[i], mode));\n\t      }\n\t\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return StickFigureJointState;\n\t}();\n\t\n\tvar StickFigure = exports.StickFigure = function () {\n\t  function StickFigure() {\n\t    _classCallCheck(this, StickFigure);\n\t  }\n\t\n\t  _createClass(StickFigure, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      this.root.draw(ctx, state.root);\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new StickFigureState();\n\t      state.root = StickFigureJointState.interpolate(t, current.root, target.root, mode);\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var figure = new StickFigure();\n\t      figure.root = StickFigureJoint.read(reader, version);\n\t      return figure;\n\t    }\n\t  }]);\n\t\n\t  return StickFigure;\n\t}();\n\t\n\tvar StickFigureState = exports.StickFigureState = function () {\n\t  function StickFigureState() {\n\t    _classCallCheck(this, StickFigureState);\n\t  }\n\t\n\t  _createClass(StickFigureState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new StickFigureState();\n\t      state.root = StickFigureJointState.read(reader, version);\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return StickFigureState;\n\t}();\n\t\n\tvar StickFigureJoint = exports.StickFigureJoint = function () {\n\t  function StickFigureJoint() {\n\t    _classCallCheck(this, StickFigureJoint);\n\t\n\t    this.parent = null;\n\t    this.children = [];\n\t    this.jointColor = [255, 0, 0, 0];\n\t    this.handleColor = [255, 0, 0, 255];\n\t    this.thickness = 6;\n\t\n\t    // this.bitmaps = [];\n\t    // this.bitmapOffsets = new Map();\n\t    this.initialBitmapIndex = -1;\n\t\n\t    this.handleVisible = true;\n\t    this.visible = true;\n\t    this.manipulatable = true;\n\t  }\n\t\n\t  _createClass(StickFigureJoint, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      if (this.children.count != state.children.count) throw new Error(\"state does not match this joint\");\n\t\n\t      for (var i = 0; i < this.children.length; i++) {\n\t        this.children[i].drawTo(ctx, state.children[i], this, state);\n\t        this.children[i].draw(ctx, state.children[i]);\n\t      }\n\t    }\n\t  }, {\n\t    key: \"drawTo\",\n\t    value: function drawTo(ctx, state, otherJoint, otherState) {\n\t      if (!this.visible) return;\n\t\n\t      switch (this.drawType) {\n\t        case \"CircleLine\":\n\t          var dx = state.location[0] - otherState.location[0];\n\t          var dy = state.location[1] - otherState.location[1];\n\t          var r = Math.sqrt(dx * dx + dy * dy) / 2;\n\t\n\t          var x = otherState.location[0] + dx / 2;\n\t          var y = otherState.location[1] + dy / 2;\n\t\n\t          (0, _Drawing.TisfatCircle)(ctx, [x, y], r, state.jointColor);\n\t          break;\n\t        case \"CircleRadius\":\n\t          (0, _Drawing.TisfatCircle)(ctx, state.location, state.thickness, state.jointColor);\n\t          break;\n\t        case \"Normal\":\n\t          (0, _Drawing.TisfatCappedLine)(ctx, state.location, otherState.location, state.thickness, state.jointColor);\n\t          break;\n\t        default:\n\t          throw new Error(\"unknown joint drawing type \" + this.drawType);\n\t      }\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var joint = new StickFigureJoint();\n\t      joint.parent = null;\n\t\n\t      joint.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      joint.jointColor = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      joint.handleColor = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      joint.thickness = reader.ReadDouble();\n\t\n\t      if (version >= 2) {\n\t        joint.drawType = reader.ReadString();\n\t        joint.handleVisible = reader.ReadBoolean();\n\t        joint.manipulatable = reader.ReadBoolean();\n\t        joint.visible = reader.ReadBoolean();\n\t      } else {\n\t        joint.drawType = reader.ReadBoolean() ? \"CircleLine\" : \"Normal\";\n\t      }\n\t\n\t      joint.children = (0, _FileFormat.TisfatReadList)(reader, version, StickFigureJoint.read);\n\t\n\t      var _iteratorNormalCompletion2 = true;\n\t      var _didIteratorError2 = false;\n\t      var _iteratorError2 = undefined;\n\t\n\t      try {\n\t        for (var _iterator2 = joint.children[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t          var child = _step2.value;\n\t\n\t          child.parent = joint;\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t            _iterator2.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError2) {\n\t            throw _iteratorError2;\n\t          }\n\t        }\n\t      }\n\t\n\t      if (version >= 4) {\n\t        var names = (0, _FileFormat.TisfatReadList)(reader, version, function (r) {\n\t          return r.ReadString();\n\t        });\n\t        var images = (0, _FileFormat.TisfatReadList)(reader, version, _FileFormat.TisfatReadBitmap);\n\t        var rotations = (0, _FileFormat.TisfatReadList)(reader, version, function (r) {\n\t          return r.ReadDouble();\n\t        });\n\t        var offsets = (0, _FileFormat.TisfatReadList)(reader, version, _FileFormat.TisfatReadPointF);\n\t\n\t        // this.bitmaps = [];\n\t        // this.bitmapOffsets = new Map();\n\t\n\t        for (var i = 0; i < names.length; i++) {\n\t          // this.bitmaps.append(); // ???\n\t          // ???\n\t        }\n\t\n\t        joint.initialBitmapIndex = reader.ReadInt32();\n\t      }\n\t\n\t      return joint;\n\t    }\n\t  }]);\n\t\n\t  return StickFigureJoint;\n\t}();\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.TisfatCircle = TisfatCircle;\n\texports.TisfatCappedLine = TisfatCappedLine;\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tfunction TisfatCircle(ctx, center, radius, color) {\n\t  ctx.beginPath();\n\t  ctx.arc(center[0], center[1], radius, 0, 2 * Math.PI, false);\n\t  ctx.fillStyle = (0, _FileFormat.TisfatColorToCSS)(color);\n\t  ctx.fill();\n\t}\n\t\n\tfunction TisfatCappedLine(ctx, a, b, thickness, color) {\n\t  ctx.beginPath();\n\t  ctx.moveTo(a[0], a[1]);\n\t  ctx.lineTo(b[0], b[1]);\n\t  ctx.lineWidth = thickness * 2;\n\t  ctx.strokeStyle = (0, _FileFormat.TisfatColorToCSS)(color);\n\t  ctx.stroke();\n\t\n\t  TisfatCircle(ctx, a, thickness, color);\n\t  TisfatCircle(ctx, b, thickness, color);\n\t}\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Interpolate = Interpolate;\n\texports.InterpolatePointF = InterpolatePointF;\n\texports.InterpolateColor = InterpolateColor;\n\tfunction Interpolate(t, a, b, mode) {\n\t  switch (mode) {\n\t    case \"None\":\n\t      return t < 1 ? a : b;\n\t    case \"Linear\":\n\t      return a + (b - a) * t;\n\t    case \"QuadInOut\":\n\t      b -= a;\n\t      t *= 2;\n\t\n\t      if (t < 1) return b / 2 * t * t + a;\n\t      t--;\n\t      return -b / 2 * (t * (t - 2) - 1) + a;\n\t    case \"ExpoInOut\":\n\t      b -= a;\n\t      t *= 2;\n\t\n\t      if (t < 1) return b / 2 * Math.pow(2, 10 * (t - 1)) + a;\n\t      t--;\n\t      return b / 2 * (-Math.pow(2, -10 * t) + 2) + a;\n\t    case \"BounceOut\":\n\t      b -= a;\n\t\n\t      if (t < 1 / 2.75) {\n\t        return b * (7.5625 * t * t) + a;\n\t      } else if (t < 2 / 2.75) {\n\t        t -= 1.5 / 2.75;\n\t        return b * (7.5625 * t * t + 0.75) + a;\n\t      } else if (t < 2.5 / 2.75) {\n\t        t -= 2.25 / 2.75;\n\t        return b * (7.5625 * t * t + 0.9375) + a;\n\t      } else {\n\t        t -= 2.625 / 2.75;\n\t        return b * (7.5625 * t * t + 0.984375) + a;\n\t      }\n\t      break; // thanks JSHint\n\t    case \"BackOut\":\n\t      b -= a;\n\t      // ew\n\t      return b * ((t = t - 1) * t * ((1.70158 + 1) * t + 1.70158) + 1) + a;\n\t    default:\n\t      throw new Error(\"unknown interpMode \" + mode);\n\t  }\n\t}\n\t\n\tfunction InterpolatePointF(t, a, b, mode) {\n\t  return [Interpolate(t, a[0], b[0], mode), Interpolate(t, a[1], b[1], mode)];\n\t}\n\t\n\tfunction InterpolateColor(t, a, b, mode) {\n\t  return [Math.max(Math.min(Interpolate(t, a[0], b[0], mode), 255), 0), Math.max(Math.min(Interpolate(t, a[1], b[1], mode), 255), 0), Math.max(Math.min(Interpolate(t, a[2], b[2], mode), 255), 0), Math.max(Math.min(Interpolate(t, a[3], b[3], mode), 255), 0)];\n\t}\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.BitmapObjectState = exports.BitmapObject = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar BitmapObject = exports.BitmapObject = function () {\n\t  function BitmapObject() {\n\t    _classCallCheck(this, BitmapObject);\n\t  }\n\t\n\t  _createClass(BitmapObject, [{\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new BitmapObjectState();\n\t      state.location = (0, _Interpolation.InterpolatePointF)(t, current.location, target.location, mode);\n\t      state.size = (0, _Interpolation.InterpolatePointF)(t, current.size, target.size, mode);\n\t      state.rotation = (0, _Interpolation.Interpolate)(t, current.rotation, target.rotation, mode);\n\t      state.alpha = (0, _Interpolation.Interpolate)(t, current.alpha, target.alpha, mode);\n\t      return state;\n\t    }\n\t  }, {\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      var _state$location = _slicedToArray(state.location, 2);\n\t\n\t      var x = _state$location[0];\n\t      var y = _state$location[1];\n\t\n\t      var _state$size = _slicedToArray(state.size, 2);\n\t\n\t      var width = _state$size[0];\n\t      var height = _state$size[1];\n\t      // TODO: rotation\n\t\n\t      ctx.globalAlpha = state.alpha;\n\t      ctx.drawImage(this.bitmap, x, y, width, height);\n\t      ctx.globalAlpha = 1;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var object = new BitmapObject();\n\t      object.bitmap = (0, _FileFormat.TisfatReadBitmap)(reader, version);\n\t      return object;\n\t    }\n\t  }]);\n\t\n\t  return BitmapObject;\n\t}();\n\t\n\tvar BitmapObjectState = exports.BitmapObjectState = function () {\n\t  function BitmapObjectState() {\n\t    _classCallCheck(this, BitmapObjectState);\n\t  }\n\t\n\t  _createClass(BitmapObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new BitmapObjectState();\n\t      state.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.size = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      var width = reader.ReadDouble();\n\t      var height = reader.ReadDouble();\n\t      state.rotation = reader.ReadDouble();\n\t\n\t      if (version >= 5) state.alpha = reader.ReadInt32() / 255;else state.alpha = 1;\n\t\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return BitmapObjectState;\n\t}();\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.LineObjectState = exports.LineObject = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Drawing = __webpack_require__(8);\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar LineObject = exports.LineObject = function () {\n\t  function LineObject() {\n\t    _classCallCheck(this, LineObject);\n\t  }\n\t\n\t  _createClass(LineObject, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      (0, _Drawing.TisfatCappedLine)(ctx, state.a, state.b, state.thickness, state.color);\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new LineObjectState();\n\t      state.a = (0, _Interpolation.InterpolatePointF)(t, current.a, target.a, mode);\n\t      state.b = (0, _Interpolation.InterpolatePointF)(t, current.b, target.b, mode);\n\t      state.color = (0, _Interpolation.InterpolateColor)(t, current.color, target.color, mode);\n\t      state.thickness = (0, _Interpolation.Interpolate)(t, current.thickness, target.thickness, mode);\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read() {\n\t      return new LineObject();\n\t    }\n\t  }]);\n\t\n\t  return LineObject;\n\t}();\n\t\n\tvar LineObjectState = exports.LineObjectState = function () {\n\t  function LineObjectState() {\n\t    _classCallCheck(this, LineObjectState);\n\t  }\n\t\n\t  _createClass(LineObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new LineObjectState();\n\t      state.a = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.b = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.color = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      state.thickness = reader.ReadDouble();\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return LineObjectState;\n\t}();\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.RectObjectState = exports.RectObject = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar RectObject = exports.RectObject = function () {\n\t  function RectObject() {\n\t    _classCallCheck(this, RectObject);\n\t  }\n\t\n\t  _createClass(RectObject, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      ctx.fillStyle = (0, _FileFormat.TisfatColorToCSS)(state.color);\n\t      ctx.fillRect(state.position[0], state.position[1], state.extent[0], state.extent[1]);\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new RectObjectState();\n\t      state.position = (0, _Interpolation.InterpolatePointF)(t, current.position, target.position, mode);\n\t      state.extent = (0, _Interpolation.InterpolatePointF)(t, current.extent, target.extent, mode);\n\t      state.color = (0, _Interpolation.InterpolateColor)(t, current.color, target.color, mode);\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read() {\n\t      return new RectObject();\n\t    }\n\t  }]);\n\t\n\t  return RectObject;\n\t}();\n\t\n\tvar RectObjectState = exports.RectObjectState = function () {\n\t  function RectObjectState() {\n\t    _classCallCheck(this, RectObjectState);\n\t  }\n\t\n\t  _createClass(RectObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new RectObjectState();\n\t      state.position = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.extent = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.color = version >= 3 ? (0, _FileFormat.TisfatReadColor)(reader, version) : [255, 0, 0, 0];\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return RectObjectState;\n\t}();\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Drawing = __webpack_require__(8);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar CircleObject = function () {\n\t  function CircleObject() {\n\t    _classCallCheck(this, CircleObject);\n\t  }\n\t\n\t  _createClass(CircleObject, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      (0, _Drawing.TisfatCircle)(ctx, state.position, state.radius, state.color);\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new CircleObjectState();\n\t      state.position = (0, _Interpolation.InterpolatePointF)(t, current.position, target.position, mode);\n\t      state.radius = (0, _Interpolation.Interpolate)(t, current.radius, target.radius, mode);\n\t      state.color = (0, _Interpolation.InterpolateColor)(t, current.color, target.color, mode);\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read() {\n\t      return new CircleObject();\n\t    }\n\t  }]);\n\t\n\t  return CircleObject;\n\t}();\n\t\n\tvar CircleObjectState = function () {\n\t  function CircleObjectState() {\n\t    _classCallCheck(this, CircleObjectState);\n\t  }\n\t\n\t  _createClass(CircleObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new CircleObjectState();\n\t      state.position = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.radius = reader.ReadDouble();\n\t      state.color = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return CircleObjectState;\n\t}();\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.PolyObjectState = exports.PolyObjectJoint = exports.PolyObject = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar PolyObject = exports.PolyObject = function () {\n\t  function PolyObject() {\n\t    _classCallCheck(this, PolyObject);\n\t  }\n\t\n\t  _createClass(PolyObject, [{\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new PolyObjectState();\n\t      state.color = (0, _Interpolation.InterpolateColor)(t, current.color, target.color, mode);\n\t\n\t      for (var i = 0; i < current.points.length; i++) {\n\t        var joint = new PolyObjectJoint();\n\t        joint.location = (0, _Interpolation.InterpolatePointF)(t, current.points[i].location, target.points[i].location, mode);\n\t        state.points.append(joint);\n\t      }\n\t\n\t      return state;\n\t    }\n\t  }, {\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      ctx.fillStyle = (0, _FileFormat.TisfatColorToCSS)(state.color);\n\t      ctx.beginPath();\n\t      var isFirst = true;\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = state.points[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var location = _step.value.location;\n\t\n\t          if (isFirst) {\n\t            ctx.moveTo(location);\n\t            isFirst = false;\n\t          } else {\n\t            ctx.lineTo(location);\n\t          }\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t\n\t      ctx.closePath();\n\t      ctx.fill();\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      return new PolyObject();\n\t    }\n\t  }]);\n\t\n\t  return PolyObject;\n\t}();\n\t\n\tvar PolyObjectJoint = exports.PolyObjectJoint = function () {\n\t  function PolyObjectJoint() {\n\t    _classCallCheck(this, PolyObjectJoint);\n\t  }\n\t\n\t  _createClass(PolyObjectJoint, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      this.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t    }\n\t  }]);\n\t\n\t  return PolyObjectJoint;\n\t}();\n\t\n\tvar PolyObjectState = exports.PolyObjectState = function () {\n\t  function PolyObjectState() {\n\t    _classCallCheck(this, PolyObjectState);\n\t  }\n\t\n\t  _createClass(PolyObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new PolyObjectState();\n\t      state.points = (0, _FileFormat.TisfatReadList)(reader, version, PolyObjectJoint.read);\n\t      state.color = (0, _FileFormat.TisfatReadColor)(reader, version);\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return PolyObjectState;\n\t}();\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.TextObjectState = exports.TextObject = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t// TODO: handle .NET FontStyle [Flags] enum\n\t// FlagsAttribute causes the enum string to be a list separated by \", \"\n\tvar FontStyleMap = {\n\t  \"Bold\": \"bold\",\n\t  \"Italic\": \"italic\",\n\t  \"Regular\": \"normal\"\n\t};\n\t\n\t/* \"Strikeout\": \"strikeout\",\n\t\"Underline\": \"underline\" */\n\tvar TextAlignmentMap = {\n\t  \"Center\": \"center\",\n\t  \"Far\": \"end\",\n\t  \"Near\": \"start\"\n\t};\n\t\n\tvar TextBaselineMap = {\n\t  \"Center\": \"middle\",\n\t  \"Far\": \"bottom\",\n\t  \"Near\": \"top\"\n\t};\n\t\n\tvar TextObject = exports.TextObject = function () {\n\t  function TextObject() {\n\t    _classCallCheck(this, TextObject);\n\t  }\n\t\n\t  _createClass(TextObject, [{\n\t    key: \"draw\",\n\t    value: function draw(ctx, state) {\n\t      ctx.font = state.textFont;\n\t      ctx.fillStyle = (0, _FileFormat.TisfatColorToCSS)(state.textColor);\n\t      ctx.textAlign = TextAlignmentMap[state.textAlignment];\n\t      ctx.textBaseline = TextBaselineMap[state.textAlignment];\n\t      // TODO: take into account state.size!\n\t      ctx.fillText(state.text, state.location, state.location);\n\t    }\n\t  }, {\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new TextObjectState();\n\t\n\t      state.location = (0, _Interpolation.InterpolatePointF)(t, current.location, target.location, mode);\n\t      state.size = (0, _Interpolation.InterpolatePointF)(t, current.size, target.size, mode);\n\t\n\t      state.text = current.text;\n\t      state.textAlignment = current.textAlignment;\n\t      state.textFont = current.textFont;\n\t      state.textColor = (0, _Interpolation.InterpolateColor)(t, current.textColor, target.textColor, mode);\n\t\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read() {\n\t      return new TextObject();\n\t    }\n\t  }]);\n\t\n\t  return TextObject;\n\t}();\n\t\n\tvar TextObjectState = exports.TextObjectState = function () {\n\t  function TextObjectState() {\n\t    _classCallCheck(this, TextObjectState);\n\t  }\n\t\n\t  _createClass(TextObjectState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new TextObjectState();\n\t      state.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.size = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.text = reader.ReadString();\n\t      var fontName = reader.ReadString();\n\t      var fontSize = reader.ReadDouble();\n\t      var fontStyle = reader.ReadString(); // ReadInt32\n\t      state.textFont = FontStyleMap[fontStyle] + \" \" + fontSize + \"px \" + fontName;\n\t      if (version > 7) state.textColor = (0, _FileFormat.TisfatReadColor)(reader, version);else state.textColor = [255, 0, 0, 0];\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return TextObjectState;\n\t}();\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Camera = exports.CameraState = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tvar _Interpolation = __webpack_require__(9);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar CameraState = exports.CameraState = function () {\n\t  function CameraState() {\n\t    _classCallCheck(this, CameraState);\n\t  }\n\t\n\t  _createClass(CameraState, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var state = new CameraState();\n\t      state.location = (0, _FileFormat.TisfatReadPointF)(reader, version);\n\t      state.scale = reader.ReadDouble();\n\t      state.angle = reader.ReadDouble();\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return CameraState;\n\t}();\n\t\n\tvar Camera = exports.Camera = function () {\n\t  function Camera() {\n\t    _classCallCheck(this, Camera);\n\t  }\n\t\n\t  _createClass(Camera, [{\n\t    key: \"interpolate\",\n\t    value: function interpolate(t, current, target, mode) {\n\t      var state = new CameraState();\n\t      state.location = (0, _Interpolation.InterpolatePointF)(t, current.location, target.location, mode);\n\t      state.angle = (0, _Interpolation.Interpolate)(t, current.angle, target.angle, mode);\n\t      state.scale = (0, _Interpolation.Interpolate)(t, current.scale, target.scale, mode);\n\t      return state;\n\t    }\n\t  }, {\n\t    key: \"draw\",\n\t    value: function draw() {/* stub */}\n\t  }, {\n\t    key: \"transform\",\n\t    value: function transform(ctx, state) {\n\t      var _state$location = _slicedToArray(state.location, 2);\n\t\n\t      var x = _state$location[0];\n\t      var y = _state$location[1];\n\t\n\t      var inv = 1 / state.scale;\n\t      // ctx.translate(-x * 1 / state.scale, -y * 1 / state.scale);\n\t      ctx.translate(-x / state.scale, -y / state.scale);\n\t      ctx.scale(inv, inv);\n\t      ctx.rotate(state.angle);\n\t    }\n\t  }, {\n\t    key: \"createRefState\",\n\t    value: function createRefState() {\n\t      var state = new CameraState();\n\t      state.location = [0, 0];\n\t      state.scale = 1;\n\t      state.angle = 0;\n\t      return state;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read() {\n\t      return new Camera();\n\t    }\n\t  }]);\n\t\n\t  return Camera;\n\t}();\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Keyframe = __webpack_require__(18);\n\t\n\tvar _Keyframe2 = _interopRequireDefault(_Keyframe);\n\t\n\tvar _FileFormat = __webpack_require__(1);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Frameset = function () {\n\t  function Frameset() {\n\t    _classCallCheck(this, Frameset);\n\t\n\t    this.keyframes = [];\n\t  }\n\t\n\t  _createClass(Frameset, [{\n\t    key: \"getStartTime\",\n\t    value: function getStartTime() {\n\t      return this.keyframes[0].time;\n\t    }\n\t  }, {\n\t    key: \"getEndTime\",\n\t    value: function getEndTime() {\n\t      return this.keyframes[this.keyframes.length - 1].time;\n\t    }\n\t  }], [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var frameset = new Frameset();\n\t      frameset.keyframes = (0, _FileFormat.TisfatReadList)(reader, version, _Keyframe2.default.read);\n\t      return frameset;\n\t    }\n\t  }]);\n\t\n\t  return Frameset;\n\t}();\n\n\texports.default = Frameset;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _EntityIDs = __webpack_require__(6);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Keyframe = function () {\n\t  function Keyframe() {\n\t    var time = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n\t    var state = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t    var interpMode = arguments.length <= 2 || arguments[2] === undefined ? \"Linear\" : arguments[2];\n\t\n\t    _classCallCheck(this, Keyframe);\n\t\n\t    this.time = time;\n\t    this.state = state;\n\t    this.interpMode = interpMode;\n\t  }\n\t\n\t  _createClass(Keyframe, null, [{\n\t    key: \"read\",\n\t    value: function read(reader, version) {\n\t      var keyframe = new Keyframe();\n\t      keyframe.time = reader.ReadUInt32();\n\t      var type = (0, _EntityIDs.TisfatResolveEntityStateID)(reader.ReadUInt16());\n\t      keyframe.interpMode = version >= 2 ? reader.ReadString() : \"Linear\";\n\t      keyframe.state = type.read(reader, version);\n\t      return keyframe;\n\t    }\n\t  }]);\n\t\n\t  return Keyframe;\n\t}();\n\n\texports.default = Keyframe;\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** build/bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 93ebeba8907a0a04b647\n **/","/* global self */\n\n\"use strict\";\n\nimport {TisfatColorToCSS} from \"./Util/FileFormat.js\";\nimport BinaryReader from \"./Util/BinaryReader.js\";\nimport Project from \"./Core/Project.js\";\n\nvar FILE_FORMAT_VERSION = 7;\n\nif (top === self)\n  document.body.style.backgroundColor = \"black\";\n\nvar eTextView = document.getElementById(\"text-view\");\nvar eMainView = document.getElementById(\"main-view\");\n\neTextView.style.display = \"block\";\neTextView.textContent = \"Initializing player...\";\n\nvar eView = document.getElementById(\"view\");\nvar eTime = document.getElementById(\"time\");\nvar eText = document.getElementById(\"text\");\nvar eLink = document.getElementById(\"link\");\nvar eBtnPlay = document.getElementById(\"btn-play\");\n\nvar project = null;\nvar isPlaying = false;\nvar playStartFrame = null;\nvar playStartTime = null;\n\nfunction playFrame(time) {\n  if (!isPlaying)\n    return;\n\n  if (playStartTime === null)\n    playStartTime = time;\n\n  // const frame = playStartFrame + (time - playStartTime) / 1000 * project.fps;\n  let frame;\n  frame = (time - playStartTime) / 1000;\n  let x = 1.0 / project.fps;\n  frame = Math.floor(frame / x) * x; // this seems inefficient\n  frame *= project.animSpeed;\n  frame += playStartFrame;\n\n  eTime.value = frame;\n  draw();\n\n  if (frame >= project.getEndTime())\n    setPlaying(false);\n  else\n    requestAnimationFrame(playFrame);\n}\n\nfunction setPlaying(state) {\n  if (state) {\n    if (!isPlaying)\n      requestAnimationFrame(playFrame);\n\n    if (eTime.value >= project.getEndTime())\n      eTime.value = 0;\n\n    isPlaying = true;\n    playStartTime = null;\n    playStartFrame = parseFloat(eTime.value);\n\n    eBtnPlay.textContent = \"Pause\";\n  }\n  else {\n    isPlaying = false;\n    playStartTime = null;\n    playStartFrame = null;\n\n    eBtnPlay.textContent = \"Play\";\n  }\n}\n\nfunction draw() {\n  if (project === null)\n    return;\n\n  eText.textContent = \"Frame \" + (Math.floor(eTime.value) + 1) + \"/\" + (project.getEndTime() + 1);\n\n  var context = eView.getContext(\"2d\");\n\n  context.fillStyle = TisfatColorToCSS(project.backgroundColor);\n  context.fillRect(0, 0, eView.width, eView.height);\n\n  context.save();\n\n  const cameraLayer = project.layers[0];\n  const cameraState = cameraLayer.findCurrentState(eTime.value);\n  cameraLayer.data.transform(context, cameraState);\n\n  project.draw(context, eTime.value);\n  context.restore();\n}\n\nfunction onProjectLoad() {\n  eTextView.style.display = \"none\";\n  eMainView.style.display = \"block\";\n\n  eView.width = project.width;\n  eView.height = project.height;\n\n  eTime.max = project.getEndTime();\n  eTime.value = 0;\n  eTime.style.width = project.width + \"px\";\n\n  draw();\n}\n\neBtnPlay.addEventListener(\"click\", () => {\n  if (project === null)\n    return;\n\n  setPlaying(!isPlaying);\n});\n\neTime.addEventListener(\"input\", () => {\n  if (isPlaying) {\n    playStartTime = null;\n    playStartFrame = parseFloat(eTime.value);\n  }\n\n  draw();\n});\n\neTextView.textContent = \"Loading TISFAT Zero project...\";\neLink.href = location.search.substring(1);\n\nclass BadVersionError {\n  constructor(version, maxSupported) {\n    this.version = version;\n    this.maxSupported = maxSupported;\n  }\n}\n\nclass HTTPError { }\n\nfetch(eLink.href).then(response => {\n  if (!response.ok)\n    throw new HTTPError();\n\n  return response.arrayBuffer();\n}).then(arrayBuffer => {\n  eTextView.textContent = \"Parsing TISFAT Zero project...\";\n  var reader = new BinaryReader(arrayBuffer, true);\n  var version = reader.ReadUInt16();\n\n  if (version > FILE_FORMAT_VERSION)\n    throw new BadVersionError(version, FILE_FORMAT_VERSION);\n\n  project = Project.read(reader, version);\n  onProjectLoad();\n}).catch(error => {\n  console.error(error);\n  console.log(error.stack);\n\n  if (error instanceof HTTPError) {\n    eTextView.textContent = `Failed to fetch the project file from '${eLink.href}'.\n                             Check for bad links or CORS support.`;\n  } else if (error instanceof BadVersionError) {\n    eTextView.textContent = `Failed to parse the project (file format version ${error.version},\n                             this viewer only supports up to version ${error.maxSupported})`;\n  } else {\n    eTextView.textContent = \"Something unhandled went wrong while trying to load the project. \" + error;\n  }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Main.js\n **/","\"use strict\";\n\n// not the right place for this\nexport function TisfatColorToCSS(color) {\n  const [a, r, g, b] = color;\n  return `rgba(${r},${g},${b},${a/255})`;\n}\n\nexport function TisfatReadList(reader, version, func) {\n  const list = [];\n  const count = reader.ReadUInt16();\n\n  for (var i = 0; i < count; i++) {\n    list.push(func(reader, version));\n  }\n\n  return list;\n}\n\nexport function TisfatReadColor(reader, version) {\n  const a = reader.ReadByte();\n  const r = reader.ReadByte();\n  const g = reader.ReadByte();\n  const b = reader.ReadByte();\n  return [a, r, g, b];\n}\n\nexport function TisfatReadBitmap(reader) {\n  const bytes = reader.ReadInt32();\n  const buffer = reader.Read(bytes);\n\n  const blob = new Blob([buffer], {type: \"image/png\"});\n\n  const domURL = window.URL || window.webkitURL || window;\n  const url = domURL.createObjectURL(blob);\n  const img = new Image();\n\n  img.onload = () => domURL.revokeObjectURL(url);\n  img.src = url;\n\n  return img;\n}\n\nexport function TisfatReadPointF(reader) {\n  const x = reader.ReadDouble();\n  const y = reader.ReadDouble();\n  return [x, y];\n}\n\nexport function TisfatReadVec3(reader) {\n  const x = reader.ReadDouble();\n  const y = reader.ReadDouble();\n  const z = reader.ReadDouble();\n  return [x, y, z];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/FileFormat.js\n **/","\"use strict\";\n\nimport ExtendableError from \"./ExtendableError.js\";\n\nexport class DataFormatError extends ExtendableError { }\n\nexport default class BinaryReader {\n  constructor(arrayBuffer, littleEndian) {\n    this.arrayBuffer = arrayBuffer;\n    this.dataView = new DataView(arrayBuffer);\n    this.littleEndian = littleEndian;\n    this.cursor = 0;\n  }\n\n  Read(count) {\n    var value = this.arrayBuffer.slice(this.cursor, this.cursor + count);\n    this.cursor += count;\n    return value;\n  }\n\n  ReadBoolean() {\n    return this.ReadByte() !== 0;\n  }\n\n  ReadByte() {\n    var value = this.dataView.getUint8(this.cursor, this.littleEndian);\n    this.cursor++;\n    return value;\n  }\n\n  ReadUInt16() {\n    var value = this.dataView.getUint16(this.cursor, this.littleEndian);\n    this.cursor += 2;\n    return value;\n  }\n\n  ReadUInt32() {\n    var value = this.dataView.getUint32(this.cursor, this.littleEndian);\n    this.cursor += 4;\n    return value;\n  }\n\n  ReadInt32() {\n    var value = this.dataView.getInt32(this.cursor, this.littleEndian);\n    this.cursor += 4;\n    return value;\n  }\n\n  ReadDouble() {\n    var value = this.dataView.getFloat64(this.cursor, this.littleEndian);\n    this.cursor += 8;\n    return value;\n  }\n\n  Read7BitEncodedInt() {\n      // Read out an Int32 7 bits at a time.  The high bit\n      // of the byte when on means to continue reading more bytes.\n      var count = 0;\n      var shift = 0;\n      var b;\n      do {\n          // Check for a corrupted stream.  Read a max of 5 bytes.\n          // In a future version, add a DataFormatException.\n          if (shift == 5 * 7)  // 5 bytes max per Int32, shift += 7\n              throw new DataFormatError(\"Bad 7-bit encoded Int32\");\n\n          // ReadByte handles end of stream cases for us.\n          b = this.ReadByte();\n          count |= (b & 0x7F) << shift;\n          shift += 7;\n      } while ((b & 0x80) !== 0);\n      return count;\n  }\n\n  ReadString() {\n    //var test = this.ReadByte();\n    //if (test >= 127) throw new Error(\"watch out\");\n    var test = this.Read7BitEncodedInt();\n    var data = this.Read(test);\n    var decoded = String.fromCharCode.apply(null, new Uint8Array(data));\n    return decoded;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/BinaryReader.js\n **/","\"use strict\";\n\nexport default class ExtendableError extends Error {\n  constructor(message) {\n    super();\n    this.message = message;\n    this.stack = (new Error()).stack;\n    this.name = this.constructor.name;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/ExtendableError.js\n **/","\"use strict\";\n\nimport Layer from \"./Layer.js\";\nimport Frameset from \"./Frameset.js\";\nimport Keyframe from \"./Keyframe.js\";\nimport {Camera} from \"../Entities/Camera.js\";\nimport {TisfatReadList, TisfatReadColor} from \"../Util/FileFormat.js\";\n\nexport default class Project {\n  constructor() {\n    this.layers = [];\n    this.animSpeed = 10.0;\n    this.fps = 60.0;\n    this.width = 460;\n    this.height = 360;\n    this.backgroundColor = [255, 255, 255, 255];\n  }\n\n  static read(reader, version) {\n    const project = new Project();\n\n    project.layers = TisfatReadList(reader, version, Layer.read);\n    console.log(project.layers.map(l => l.name));\n\n    if (version < 6) {\n      project.layers.unshift(project.createCameraLayer());\n      /* Camera camera = new Camera();\n      Layers.Insert(0, camera.CreateDefaultLayer(0, (uint)Program.MainTimeline.GetLastTime(), null)); */\n    }\n\n    if (version >= 1) {\n      project.animSpeed = reader.ReadDouble();\n\n      if (version >= 5)\n        project.fps = reader.ReadDouble();\n\n      if (version >= 2) {\n        project.width = reader.ReadInt32();\n        project.height = reader.ReadInt32();\n        project.backgroundColor = TisfatReadColor(reader, version);\n      }\n    }\n\n    return project;\n  }\n\n  draw(ctx, time) {\n    for (let layer of this.layers) {\n      layer.draw(ctx, time);\n    }\n  }\n\n  getEndTime() {\n    let endTime = 0;\n\n    for (let layer of this.layers) {\n      endTime = Math.max(endTime,\n        layer.framesets[layer.framesets.length - 1].getEndTime());\n    }\n\n    return endTime;\n  }\n\n  createCameraLayer() {\n    const camera = new Camera();\n    const layer = new Layer();\n    const frameset = new Frameset();\n\n    layer.name = \"Camera\";\n    layer.timelineColor = [255, 70, 120, 255];\n    layer.data = camera;\n\n    frameset.keyframes.push(new Keyframe(0, camera.createRefState()));\n    frameset.keyframes.push(new Keyframe(this.getEndTime(), camera.createRefState()));\n    layer.framesets.push(frameset);\n\n    return layer;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Core/Project.js\n **/","\"use strict\";\n\nimport {TisfatReadColor, TisfatReadList} from \"../Util/FileFormat.js\";\nimport {TisfatResolveEntityID} from \"../Util/EntityIDs.js\";\nimport Frameset from \"./Frameset.js\";\n\nexport default class Layer {\n  constructor() {\n    this.name = \"Layer\";\n    this.visible = true;\n    this.timelineColor = \"aliceblue\";\n    this.data = null;\n    this.framesets = [];\n    this.depth = 0;\n  }\n\n  static read(reader, version) {\n    const layer = new Layer();\n    layer.name = reader.ReadString();\n    layer.visible = reader.ReadBoolean();\n    layer.timelineColor = TisfatReadColor(reader, version);\n    const type = TisfatResolveEntityID(reader.ReadUInt16());\n    layer.data = type.read(reader, version);\n    layer.framesets = TisfatReadList(reader, version, Frameset.read);\n\n    return layer;\n  }\n\n  findFrameset(time) {\n    for (let frameset of this.framesets) {\n      if (time >= frameset.getStartTime() && time <= frameset.getEndTime())\n        return frameset;\n    }\n\n    return null;\n  }\n\n  findCurrentState(time) {\n    if (!this.visible || this.data === null)\n      return null;\n\n    const frameset = this.findFrameset(time);\n\n    if (frameset === null)\n      return null;\n\n    let nextIndex;\n\n    for (nextIndex = 1; nextIndex < frameset.keyframes.length; nextIndex++) {\n      if (frameset.keyframes[nextIndex].time >= time)\n        break;\n    }\n\n    const current = frameset.keyframes[nextIndex - 1];\n    const target = frameset.keyframes[nextIndex];\n\n    const t = (time - current.time) / (target.time - current.time);\n    return this.data.interpolate(t, current.state, target.state, current.interpMode);\n  }\n\n  draw(ctx, time) {\n    const state = this.findCurrentState(time);\n\n    if (state !== null)\n      this.data.draw(ctx, state);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Core/Layer.js\n **/","\"use strict\";\n\nimport {StickFigure, StickFigureState} from \"../Entities/StickFigure.js\";\nimport {BitmapObject, BitmapObjectState} from \"../Entities/BitmapObject.js\";\n// import {PointLight, PointLightState} from \"../Entities/PointLight.js\";\nimport {LineObject, LineObjectState} from \"../Entities/LineObject.js\";\nimport {RectObject, RectObjectState} from \"../Entities/RectObject.js\";\nimport {CircleObject, CircleObjectState} from \"../Entities/CircleObject.js\";\nimport {PolyObject, PolyObjectState} from \"../Entities/PolyObject.js\";\nimport {TextObject, TextObjectState} from \"../Entities/TextObject.js\";\nimport {Camera, CameraState} from \"../Entities/Camera.js\";\n\nconst TisfatEntityTypes = {\n  \"0\": StickFigure,\n  \"1\": BitmapObject,\n  // \"2\": PointLight,\n  \"3\": LineObject,\n  \"4\": RectObject,\n  \"5\": CircleObject,\n  \"6\": PolyObject,\n  \"7\": TextObject,\n  \"8\": /* CustomFigure */ StickFigure,\n  \"9\": Camera\n};\n\nconst TisfatEntityStateTypes = {\n  \"0\": StickFigureState,\n  \"1\": BitmapObjectState,\n  // \"2\": PointLightState,\n  \"3\": LineObjectState,\n  \"4\": RectObjectState,\n  \"5\": CircleObjectState,\n  \"6\": PolyObjectState,\n  \"7\": TextObjectState,\n  \"8\": /* CustomFigureState */ StickFigureState,\n  \"9\": CameraState\n};\n\nexport function TisfatResolveEntityID(id) {\n  if (TisfatEntityTypes[id])\n    return TisfatEntityTypes[id];\n\n  throw new Error(\"cannot resolve entity id \" + id);\n}\n\nexport function TisfatResolveEntityStateID(id) {\n  if (TisfatEntityStateTypes[id])\n    return TisfatEntityStateTypes[id];\n\n  throw new Error(\"cannot resolve entity state id \" + id);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/EntityIDs.js\n **/","\"use strict\";\n\nimport {TisfatReadPointF, TisfatReadColor, TisfatReadList, TisfatReadBitmap} from \"../Util/FileFormat.js\";\nimport {TisfatCircle, TisfatCappedLine} from \"../Util/Drawing.js\";\nimport {Interpolate, InterpolateColor, InterpolatePointF} from \"../Util/Interpolation.js\";\n\nexport class StickFigureJointState {\n  constructor() {\n    this.parent = null;\n    this.children = [];\n    this.location = [0, 0];\n    this.jointColor = [255, 0, 0, 0];\n    this.thickness = 6;\n    this.bitmapIndex = -1;\n    this.manipulatable = true;\n  }\n\n  static read(reader, version) {\n    const state = new StickFigureJointState();\n    state.location = TisfatReadPointF(reader, version);\n    state.jointColor = TisfatReadColor(reader, version);\n    state.thickness = reader.ReadDouble();\n\n    if (version >= 2) {\n      state.manipulatable = reader.ReadBoolean();\n\n      if (version >= 4)\n        state.bitmapIndex = reader.ReadInt32();\n    }\n\n    state.children = TisfatReadList(reader, version, StickFigureJointState.read);\n\n    for (let child of state.children)\n      child.parent = state;\n\n    return state;\n  }\n\n  static interpolate(t, current, target, mode) {\n    const state = new StickFigureJointState();\n    state.parent = current.parent;\n    state.bitmapIndex = current.bitmapIndex;\n\n    state.location = InterpolatePointF(t, current.location, target.location, mode);\n    state.jointColor = InterpolateColor(t, current.jointColor, target.jointColor, mode);\n    state.thickness = Interpolate(t, current.thickness, target.thickness, mode);\n\n    for (var i = 0; i < current.children.length; i++) {\n      state.children.push(StickFigureJointState.interpolate(t, current.children[i], target.children[i], mode));\n    }\n\n    return state;\n  }\n}\n\nexport class StickFigure {\n  static read(reader, version) {\n    const figure = new StickFigure();\n    figure.root = StickFigureJoint.read(reader, version);\n    return figure;\n  }\n\n  draw(ctx, state) {\n    this.root.draw(ctx, state.root);\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new StickFigureState();\n    state.root = StickFigureJointState.interpolate(t, current.root, target.root, mode);\n    return state;\n  }\n}\n\nexport class StickFigureState {\n  static read(reader, version) {\n    const state = new StickFigureState();\n    state.root = StickFigureJointState.read(reader, version);\n    return state;\n  }\n}\n\nexport class StickFigureJoint {\n  constructor() {\n    this.parent = null;\n    this.children = [];\n    this.jointColor = [255, 0, 0, 0];\n    this.handleColor = [255, 0, 0, 255];\n    this.thickness = 6;\n\n    // this.bitmaps = [];\n    // this.bitmapOffsets = new Map();\n    this.initialBitmapIndex = -1;\n\n    this.handleVisible = true;\n    this.visible = true;\n    this.manipulatable = true;\n  }\n\n  static read(reader, version) {\n    const joint = new StickFigureJoint();\n    joint.parent = null;\n\n    joint.location = TisfatReadPointF(reader, version);\n    joint.jointColor = TisfatReadColor(reader, version);\n    joint.handleColor = TisfatReadColor(reader, version);\n    joint.thickness = reader.ReadDouble();\n\n    if (version >= 2) {\n      joint.drawType = reader.ReadString();\n      joint.handleVisible = reader.ReadBoolean();\n      joint.manipulatable = reader.ReadBoolean();\n      joint.visible = reader.ReadBoolean();\n    } else {\n      joint.drawType = reader.ReadBoolean() ? \"CircleLine\" : \"Normal\";\n    }\n\n    joint.children = TisfatReadList(reader, version, StickFigureJoint.read);\n\n    for (let child of joint.children)\n      child.parent = joint;\n\n    if (version >= 4) {\n      const names = TisfatReadList(reader, version, r => r.ReadString());\n      const images = TisfatReadList(reader, version, TisfatReadBitmap);\n      const rotations = TisfatReadList(reader, version, r => r.ReadDouble());\n      const offsets = TisfatReadList(reader, version, TisfatReadPointF);\n\n      // this.bitmaps = [];\n      // this.bitmapOffsets = new Map();\n\n      for (let i = 0; i < names.length; i++) {\n        // this.bitmaps.append(); // ???\n        // ???\n      }\n\n      joint.initialBitmapIndex = reader.ReadInt32();\n    }\n\n    return joint;\n  }\n\n  draw(ctx, state) {\n    if (this.children.count != state.children.count)\n      throw new Error(\"state does not match this joint\");\n\n    for (let i = 0; i < this.children.length; i++) {\n      this.children[i].drawTo(ctx, state.children[i], this, state);\n      this.children[i].draw(ctx, state.children[i]);\n    }\n  }\n\n  drawTo(ctx, state, otherJoint, otherState) {\n    if (!this.visible)\n      return;\n\n    switch (this.drawType) {\n    case \"CircleLine\":\n      const dx = state.location[0] - otherState.location[0];\n      const dy = state.location[1] - otherState.location[1];\n      const r = Math.sqrt(dx * dx + dy * dy) / 2;\n\n      const x = otherState.location[0] + dx / 2;\n      const y = otherState.location[1] + dy / 2;\n\n      TisfatCircle(ctx, [x, y], r, state.jointColor);\n      break;\n    case \"CircleRadius\":\n      TisfatCircle(ctx, state.location, state.thickness, state.jointColor);\n      break;\n    case \"Normal\":\n      TisfatCappedLine(ctx, state.location, otherState.location, state.thickness, state.jointColor);\n      break;\n    default:\n      throw new Error(`unknown joint drawing type ${this.drawType}`);\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/StickFigure.js\n **/","\"use strict\";\n\nimport {TisfatColorToCSS} from \"./FileFormat.js\";\n\nexport function TisfatCircle(ctx, center, radius, color) {\n  ctx.beginPath();\n  ctx.arc(center[0], center[1], radius, 0, 2 * Math.PI, false);\n  ctx.fillStyle = TisfatColorToCSS(color);\n  ctx.fill();\n}\n\nexport function TisfatCappedLine(ctx, a, b, thickness, color) {\n  ctx.beginPath();\n  ctx.moveTo(a[0], a[1]);\n  ctx.lineTo(b[0], b[1]);\n  ctx.lineWidth = thickness * 2;\n  ctx.strokeStyle = TisfatColorToCSS(color);\n  ctx.stroke();\n\n  TisfatCircle(ctx, a, thickness, color);\n  TisfatCircle(ctx, b, thickness, color);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/Drawing.js\n **/","\"use strict\";\n\nexport function Interpolate(t, a, b, mode) {\n  switch (mode) {\n  case \"None\": return t < 1 ? a : b;\n  case \"Linear\": return a + (b - a) * t;\n  case \"QuadInOut\":\n    b -= a;\n    t *= 2;\n\n    if (t < 1) return b / 2 * t * t + a;\n    t--;\n    return -b / 2 * (t * (t - 2) - 1) + a;\n  case \"ExpoInOut\":\n    b -= a;\n    t *= 2;\n\n    if (t < 1) return b / 2 * Math.pow(2, 10 * (t - 1)) + a;\n    t--;\n    return b / 2 * (-Math.pow(2, -10 * t) + 2) + a;\n  case \"BounceOut\":\n    b -= a;\n\n    if (t < 1 / 2.75)\n    {\n      return b * (7.5625 * t * t) + a;\n    }\n    else if (t < 2 / 2.75)\n    {\n      t -= 1.5 / 2.75;\n      return b * (7.5625 * t * t + 0.75) + a;\n    }\n    else if (t < 2.5 / 2.75)\n    {\n      t -= 2.25 / 2.75;\n      return b * (7.5625 * t * t + 0.9375) + a;\n    }\n    else\n    {\n      t -= 2.625 / 2.75;\n      return b * (7.5625 * t * t + 0.984375) + a;\n    }\n    break; // thanks JSHint\n  case \"BackOut\":\n    b -= a;\n    // ew\n    return b * ((t = t - 1) * t * ((1.70158 + 1) * t + 1.70158) + 1) + a;\n  default:\n    throw new Error(\"unknown interpMode \" + mode);\n  }\n}\n\nexport function InterpolatePointF(t, a, b, mode) {\n  return [Interpolate(t, a[0], b[0], mode), Interpolate(t, a[1], b[1], mode)];\n}\n\nexport function InterpolateColor(t, a, b, mode) {\n  return [\n    Math.max(Math.min(Interpolate(t, a[0], b[0], mode), 255), 0),\n    Math.max(Math.min(Interpolate(t, a[1], b[1], mode), 255), 0),\n    Math.max(Math.min(Interpolate(t, a[2], b[2], mode), 255), 0),\n    Math.max(Math.min(Interpolate(t, a[3], b[3], mode), 255), 0)\n  ];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Util/Interpolation.js\n **/","\"use strict\";\r\n\r\nimport {TisfatReadBitmap, TisfatReadPointF} from \"../Util/FileFormat.js\";\r\nimport {Interpolate, InterpolatePointF} from \"../Util/Interpolation.js\";\r\n\r\nexport class BitmapObject {\r\n  static read(reader, version) {\r\n    const object = new BitmapObject();\r\n    object.bitmap = TisfatReadBitmap(reader, version);\r\n    return object;\r\n  }\r\n\r\n  interpolate(t, current, target, mode) {\r\n    const state = new BitmapObjectState();\r\n    state.location = InterpolatePointF(t, current.location, target.location, mode);\r\n    state.size = InterpolatePointF(t, current.size, target.size, mode);\r\n    state.rotation = Interpolate(t, current.rotation, target.rotation, mode);\r\n    state.alpha = Interpolate(t, current.alpha, target.alpha, mode);\r\n    return state;\r\n  }\r\n\r\n  draw(ctx, state) {\r\n    const [x, y] = state.location;\r\n    const [width, height] = state.size;\r\n    // TODO: rotation\r\n    ctx.globalAlpha = state.alpha;\r\n    ctx.drawImage(this.bitmap, x, y, width, height);\r\n    ctx.globalAlpha = 1;\r\n  }\r\n}\r\n\r\nexport class BitmapObjectState {\r\n  static read(reader, version) {\r\n    const state = new BitmapObjectState();\r\n    state.location = TisfatReadPointF(reader, version);\r\n    state.size = TisfatReadPointF(reader, version);\r\n    const width = reader.ReadDouble();\r\n    const height = reader.ReadDouble();\r\n    state.rotation = reader.ReadDouble();\r\n\r\n    if (version >= 5)\r\n      state.alpha = reader.ReadInt32() / 255;\r\n    else\r\n      state.alpha = 1;\r\n\r\n    return state;\r\n  }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/BitmapObject.js\n **/","\"use strict\";\n\nimport {TisfatCappedLine} from \"../Util/Drawing.js\";\nimport {TisfatReadPointF, TisfatReadColor} from \"../Util/FileFormat.js\";\nimport {Interpolate, InterpolatePointF, InterpolateColor} from \"../Util/Interpolation.js\";\n\nexport class LineObject {\n  static read() {\n    return new LineObject();\n  }\n\n  draw(ctx, state) {\n    TisfatCappedLine(ctx, state.a, state.b, state.thickness, state.color);\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new LineObjectState();\n    state.a = InterpolatePointF(t, current.a, target.a, mode);\n    state.b = InterpolatePointF(t, current.b, target.b, mode);\n    state.color = InterpolateColor(t, current.color, target.color, mode);\n    state.thickness = Interpolate(t, current.thickness, target.thickness, mode);\n    return state;\n  }\n}\n\nexport class LineObjectState {\n  static read(reader, version) {\n    const state = new LineObjectState();\n    state.a = TisfatReadPointF(reader, version);\n    state.b = TisfatReadPointF(reader, version);\n    state.color = TisfatReadColor(reader, version);\n    state.thickness = reader.ReadDouble();\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/LineObject.js\n **/","\"use strict\";\n\nimport {TisfatColorToCSS, TisfatReadPointF, TisfatReadColor} from \"../Util/FileFormat.js\";\nimport {InterpolatePointF, InterpolateColor} from \"../Util/Interpolation.js\";\n\nexport class RectObject {\n  static read() {\n    return new RectObject();\n  }\n\n  draw(ctx, state) {\n    ctx.fillStyle = TisfatColorToCSS(state.color);\n    ctx.fillRect(state.position[0], state.position[1], state.extent[0], state.extent[1]);\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new RectObjectState();\n    state.position = InterpolatePointF(t, current.position, target.position, mode);\n    state.extent = InterpolatePointF(t, current.extent, target.extent, mode);\n    state.color = InterpolateColor(t, current.color, target.color, mode);\n    return state;\n  }\n}\n\nexport class RectObjectState {\n  static read(reader, version) {\n    const state = new RectObjectState();\n    state.position = TisfatReadPointF(reader, version);\n    state.extent = TisfatReadPointF(reader, version);\n    state.color = version >= 3 ? TisfatReadColor(reader, version) : [255, 0, 0, 0];\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/RectObject.js\n **/","\"use strict\";\n\nimport {TisfatCircle} from \"../Util/Drawing.js\";\nimport {Interpolate, InterpolatePointF, InterpolateColor} from \"../Util/Interpolation.js\";\nimport {TisfatReadPointF, TisfatReadColor} from \"../Util/FileFormat.js\";\n\nclass CircleObject {\n  static read() {\n    return new CircleObject();\n  }\n\n  draw(ctx, state) {\n    TisfatCircle(ctx, state.position, state.radius, state.color);\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new CircleObjectState();\n    state.position = InterpolatePointF(t, current.position, target.position, mode);\n    state.radius = Interpolate(t, current.radius, target.radius, mode);\n    state.color = InterpolateColor(t, current.color, target.color, mode);\n    return state;\n  }\n}\n\nclass CircleObjectState {\n  static read(reader, version) {\n    const state = new CircleObjectState();\n    state.position = TisfatReadPointF(reader, version);\n    state.radius = reader.ReadDouble();\n    state.color = TisfatReadColor(reader, version);\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/CircleObject.js\n **/","\"use strict\";\n\nimport {TisfatColorToCSS, TisfatReadList, TisfatReadPointF, TisfatReadColor} from \"../Util/FileFormat.js\";\nimport {InterpolateColor, InterpolatePointF} from \"../Util/Interpolation.js\";\n\nexport class PolyObject {\n  static read(reader, version) {\n    return new PolyObject();\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new PolyObjectState();\n    state.color = InterpolateColor(t, current.color, target.color, mode);\n\n    for (let i = 0; i < current.points.length; i++) {\n      const joint = new PolyObjectJoint();\n      joint.location = InterpolatePointF(t, current.points[i].location, target.points[i].location, mode);\n      state.points.append(joint);\n    }\n\n    return state;\n  }\n\n  draw(ctx, state) {\n    ctx.fillStyle = TisfatColorToCSS(state.color);\n    ctx.beginPath();\n    let isFirst = true;\n    for (let {location} of state.points) {\n      if (isFirst) {\n        ctx.moveTo(location);\n        isFirst = false;\n      } else {\n        ctx.lineTo(location);\n      }\n    }\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n\nexport class PolyObjectJoint {\n  static read(reader, version) {\n    this.location = TisfatReadPointF(reader, version);\n  }\n}\n\nexport class PolyObjectState {\n  static read(reader, version) {\n    const state = new PolyObjectState();\n    state.points = TisfatReadList(reader, version, PolyObjectJoint.read);\n    state.color = TisfatReadColor(reader, version);\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/PolyObject.js\n **/","\"use strict\";\n\nimport {TisfatColorToCSS, TisfatReadPointF, TisfatReadColor} from \"../Util/FileFormat.js\";\nimport {InterpolateColor, InterpolatePointF} from \"../Util/Interpolation.js\";\n\n// TODO: handle .NET FontStyle [Flags] enum\n// FlagsAttribute causes the enum string to be a list separated by \", \"\nconst FontStyleMap = {\n  \"Bold\": \"bold\",\n  \"Italic\": \"italic\",\n  \"Regular\": \"normal\",\n  /* \"Strikeout\": \"strikeout\",\n  \"Underline\": \"underline\" */\n};\n\nconst TextAlignmentMap = {\n  \"Center\": \"center\",\n  \"Far\": \"end\",\n  \"Near\": \"start\"\n};\n\nconst TextBaselineMap = {\n  \"Center\": \"middle\",\n  \"Far\": \"bottom\",\n  \"Near\": \"top\"\n};\n\nexport class TextObject {\n  static read() {\n    return new TextObject();\n  }\n\n  draw(ctx, state) {\n    ctx.font = state.textFont;\n    ctx.fillStyle = TisfatColorToCSS(state.textColor);\n    ctx.textAlign = TextAlignmentMap[state.textAlignment];\n    ctx.textBaseline = TextBaselineMap[state.textAlignment];\n    // TODO: take into account state.size!\n    ctx.fillText(state.text, state.location, state.location);\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new TextObjectState();\n\n    state.location = InterpolatePointF(t, current.location, target.location, mode);\n    state.size = InterpolatePointF(t, current.size, target.size, mode);\n\n    state.text = current.text;\n    state.textAlignment = current.textAlignment;\n    state.textFont = current.textFont;\n    state.textColor = InterpolateColor(t, current.textColor, target.textColor, mode);\n\n    return state;\n  }\n}\n\nexport class TextObjectState {\n  static read(reader, version) {\n    const state = new TextObjectState();\n    state.location = TisfatReadPointF(reader, version);\n    state.size = TisfatReadPointF(reader, version);\n    state.text = reader.ReadString();\n    const fontName = reader.ReadString();\n    const fontSize = reader.ReadDouble();\n    const fontStyle = reader.ReadString(); // ReadInt32\n    state.textFont = `${FontStyleMap[fontStyle]} ${fontSize}px ${fontName}`;\n    if (version > 7)\n      state.textColor = TisfatReadColor(reader, version);\n    else\n      state.textColor = [255, 0, 0, 0];\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/TextObject.js\n **/","\"use strict\";\n\nimport {TisfatReadPointF} from \"../Util/FileFormat.js\";\nimport {Interpolate, InterpolatePointF} from \"../Util/Interpolation.js\";\n\nexport class CameraState {\n  static read(reader, version) {\n    const state = new CameraState();\n    state.location = TisfatReadPointF(reader, version);\n    state.scale = reader.ReadDouble();\n    state.angle = reader.ReadDouble();\n    return state;\n  }\n}\n\nexport class Camera {\n  static read() {\n    return new Camera();\n  }\n\n  interpolate(t, current, target, mode) {\n    const state = new CameraState();\n    state.location = InterpolatePointF(t, current.location, target.location, mode);\n    state.angle = Interpolate(t, current.angle, target.angle, mode);\n    state.scale = Interpolate(t, current.scale, target.scale, mode);\n    return state;\n  }\n\n  draw() { /* stub */ }\n\n  transform(ctx, state) {\n    const [x, y] = state.location;\n    const inv = 1 / state.scale;\n    // ctx.translate(-x * 1 / state.scale, -y * 1 / state.scale);\n    ctx.translate(-x / state.scale, -y / state.scale);\n    ctx.scale(inv, inv);\n    ctx.rotate(state.angle);\n  }\n\n  createRefState() {\n    const state = new CameraState();\n    state.location = [0, 0];\n    state.scale = 1;\n    state.angle = 0;\n    return state;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Entities/Camera.js\n **/","\"use strict\";\n\nimport Keyframe from \"./Keyframe.js\";\nimport {TisfatReadList} from \"../Util/FileFormat.js\";\n\nexport default class Frameset {\n  constructor() {\n    this.keyframes = [];\n  }\n\n  static read(reader, version) {\n    const frameset = new Frameset();\n    frameset.keyframes = TisfatReadList(reader, version, Keyframe.read);\n    return frameset;\n  }\n\n  getStartTime() {\n    return this.keyframes[0].time;\n  }\n\n  getEndTime() {\n    return this.keyframes[this.keyframes.length - 1].time;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Core/Frameset.js\n **/","\"use strict\";\n\nimport {TisfatResolveEntityStateID} from \"../Util/EntityIDs.js\";\n\nexport default class Keyframe {\n  constructor(time=0, state=null, interpMode=\"Linear\") {\n    this.time = time;\n    this.state = state;\n    this.interpMode = interpMode;\n  }\n\n  static read(reader, version) {\n    const keyframe = new Keyframe();\n    keyframe.time = reader.ReadUInt32();\n    const type = TisfatResolveEntityStateID(reader.ReadUInt16());\n    keyframe.interpMode = version >= 2 ? reader.ReadString() : \"Linear\";\n    keyframe.state = type.read(reader, version);\n    return keyframe;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/Core/Keyframe.js\n **/"],"sourceRoot":""}